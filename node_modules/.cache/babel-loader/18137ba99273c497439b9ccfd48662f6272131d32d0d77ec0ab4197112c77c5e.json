{"ast":null,"code":"var _jsxFileName = \"c:\\\\New folder (2)\\\\src\\\\components\\\\LayoutCanvas.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport * as turf from '@turf/turf';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function LayoutCanvas({\n  zoneW,\n  zoneH,\n  polygonPoints,\n  isPolygonClosed,\n  placements,\n  margin\n}) {\n  _s();\n  const ref = useRef();\n  const scale = 100;\n  useEffect(() => {\n    const c = ref.current,\n      ctx = c.getContext('2d');\n    c.width = zoneW * scale;\n    c.height = zoneH * scale;\n    ctx.clearRect(0, 0, c.width, c.height);\n\n    // draw room polygon\n    if (polygonPoints.length) {\n      ctx.strokeStyle = '#0066CC';\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      polygonPoints.forEach((p, i) => {\n        const X = p.x * scale,\n          Y = p.y * scale;\n        i === 0 ? ctx.moveTo(X, Y) : ctx.lineTo(X, Y);\n      });\n      if (isPolygonClosed) ctx.closePath();\n      ctx.stroke();\n    }\n\n    // draw tiles\n    placements.forEach(t => {\n      ctx.fillStyle = '#DDD';\n      ctx.strokeStyle = '#333';\n      ctx.lineWidth = 1;\n      ctx.fillRect(t.x * scale, t.y * scale, t.width * scale, t.height * scale);\n      ctx.strokeRect(t.x * scale, t.y * scale, t.width * scale, t.height * scale);\n    });\n\n    // draw 207mm boundary around union of tiles\n    if (placements.length) {\n      let uni = null;\n      placements.forEach(t => {\n        const poly = turf.polygon([[[t.x, t.y], [t.x + t.width, t.y], [t.x + t.width, t.y + t.height], [t.x, t.y + t.height], [t.x, t.y]]]);\n        uni = uni ? turf.union(uni, poly) : poly;\n      });\n      const buf = turf.buffer(uni, margin, {\n        units: 'meters'\n      });\n      if (buf && buf.geometry) {\n        ctx.strokeStyle = '#F00';\n        ctx.setLineDash([6, 4]);\n        ctx.lineWidth = 2;\n        const drawRing = ring => {\n          ctx.beginPath();\n          ring.forEach(([px, py], i) => {\n            const X = px * scale,\n              Y = py * scale;\n            i === 0 ? ctx.moveTo(X, Y) : ctx.lineTo(X, Y);\n          });\n          ctx.closePath();\n          ctx.stroke();\n        };\n        const g = buf.geometry;\n        if (g.type === 'Polygon') drawRing(g.coordinates[0]);else g.coordinates.forEach(poly => drawRing(poly[0]));\n        ctx.setLineDash([]);\n      }\n    }\n  }, [zoneW, zoneH, polygonPoints, isPolygonClosed, placements, margin]);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: ref,\n    style: {\n      border: '1px solid #333',\n      marginTop: 20\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 10\n  }, this);\n}\n_s(LayoutCanvas, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c = LayoutCanvas;\nvar _c;\n$RefreshReg$(_c, \"LayoutCanvas\");","map":{"version":3,"names":["React","useRef","useEffect","turf","jsxDEV","_jsxDEV","LayoutCanvas","zoneW","zoneH","polygonPoints","isPolygonClosed","placements","margin","_s","ref","scale","c","current","ctx","getContext","width","height","clearRect","length","strokeStyle","lineWidth","beginPath","forEach","p","i","X","x","Y","y","moveTo","lineTo","closePath","stroke","t","fillStyle","fillRect","strokeRect","uni","poly","polygon","union","buf","buffer","units","geometry","setLineDash","drawRing","ring","px","py","g","type","coordinates","style","border","marginTop","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["c:/New folder (2)/src/components/LayoutCanvas.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\r\nimport * as turf from '@turf/turf';\r\n\r\nexport default function LayoutCanvas({\r\n  zoneW, zoneH, polygonPoints, isPolygonClosed,\r\n  placements, margin\r\n}) {\r\n  const ref = useRef();\r\n  const scale = 100;\r\n\r\n  useEffect(() => {\r\n    const c = ref.current, ctx = c.getContext('2d');\r\n    c.width = zoneW * scale;\r\n    c.height = zoneH * scale;\r\n    ctx.clearRect(0,0,c.width,c.height);\r\n\r\n    // draw room polygon\r\n    if (polygonPoints.length) {\r\n      ctx.strokeStyle='#0066CC'; ctx.lineWidth=2;\r\n      ctx.beginPath();\r\n      polygonPoints.forEach((p,i) => {\r\n        const X=p.x*scale, Y=p.y*scale;\r\n        i===0 ? ctx.moveTo(X,Y) : ctx.lineTo(X,Y);\r\n      });\r\n      if (isPolygonClosed) ctx.closePath();\r\n      ctx.stroke();\r\n    }\r\n\r\n    // draw tiles\r\n    placements.forEach(t => {\r\n      ctx.fillStyle='#DDD';\r\n      ctx.strokeStyle='#333';\r\n      ctx.lineWidth=1;\r\n      ctx.fillRect(t.x*scale,t.y*scale,t.width*scale,t.height*scale);\r\n      ctx.strokeRect(t.x*scale,t.y*scale,t.width*scale,t.height*scale);\r\n    });\r\n\r\n    // draw 207mm boundary around union of tiles\r\n    if (placements.length) {\r\n      let uni = null;\r\n      placements.forEach(t => {\r\n        const poly = turf.polygon([[\r\n          [t.x, t.y],\r\n          [t.x+t.width, t.y],\r\n          [t.x+t.width, t.y+t.height],\r\n          [t.x, t.y+t.height],\r\n          [t.x, t.y]\r\n        ]]);\r\n        uni = uni ? turf.union(uni, poly) : poly;\r\n      });\r\n      const buf = turf.buffer(uni, margin, { units: 'meters' });\r\n      if (buf && buf.geometry) {\r\n        ctx.strokeStyle='#F00';\r\n        ctx.setLineDash([6,4]);\r\n        ctx.lineWidth=2;\r\n        const drawRing = ring => {\r\n          ctx.beginPath();\r\n          ring.forEach(([px,py],i)=> {\r\n            const X=px*scale, Y=py*scale;\r\n            i===0?ctx.moveTo(X,Y):ctx.lineTo(X,Y);\r\n          });\r\n          ctx.closePath(); ctx.stroke();\r\n        };\r\n        const g = buf.geometry;\r\n        if (g.type==='Polygon') drawRing(g.coordinates[0]);\r\n        else g.coordinates.forEach(poly=>drawRing(poly[0]));\r\n        ctx.setLineDash([]);\r\n      }\r\n    }\r\n  }, [zoneW,zoneH,polygonPoints,isPolygonClosed,placements,margin]);\r\n\r\n  return <canvas ref={ref} style={{border:'1px solid #333',marginTop:20}} />;\r\n}\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAChD,OAAO,KAAKC,IAAI,MAAM,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnC,eAAe,SAASC,YAAYA,CAAC;EACnCC,KAAK;EAAEC,KAAK;EAAEC,aAAa;EAAEC,eAAe;EAC5CC,UAAU;EAAEC;AACd,CAAC,EAAE;EAAAC,EAAA;EACD,MAAMC,GAAG,GAAGb,MAAM,CAAC,CAAC;EACpB,MAAMc,KAAK,GAAG,GAAG;EAEjBb,SAAS,CAAC,MAAM;IACd,MAAMc,CAAC,GAAGF,GAAG,CAACG,OAAO;MAAEC,GAAG,GAAGF,CAAC,CAACG,UAAU,CAAC,IAAI,CAAC;IAC/CH,CAAC,CAACI,KAAK,GAAGb,KAAK,GAAGQ,KAAK;IACvBC,CAAC,CAACK,MAAM,GAAGb,KAAK,GAAGO,KAAK;IACxBG,GAAG,CAACI,SAAS,CAAC,CAAC,EAAC,CAAC,EAACN,CAAC,CAACI,KAAK,EAACJ,CAAC,CAACK,MAAM,CAAC;;IAEnC;IACA,IAAIZ,aAAa,CAACc,MAAM,EAAE;MACxBL,GAAG,CAACM,WAAW,GAAC,SAAS;MAAEN,GAAG,CAACO,SAAS,GAAC,CAAC;MAC1CP,GAAG,CAACQ,SAAS,CAAC,CAAC;MACfjB,aAAa,CAACkB,OAAO,CAAC,CAACC,CAAC,EAACC,CAAC,KAAK;QAC7B,MAAMC,CAAC,GAACF,CAAC,CAACG,CAAC,GAAChB,KAAK;UAAEiB,CAAC,GAACJ,CAAC,CAACK,CAAC,GAAClB,KAAK;QAC9Bc,CAAC,KAAG,CAAC,GAAGX,GAAG,CAACgB,MAAM,CAACJ,CAAC,EAACE,CAAC,CAAC,GAAGd,GAAG,CAACiB,MAAM,CAACL,CAAC,EAACE,CAAC,CAAC;MAC3C,CAAC,CAAC;MACF,IAAItB,eAAe,EAAEQ,GAAG,CAACkB,SAAS,CAAC,CAAC;MACpClB,GAAG,CAACmB,MAAM,CAAC,CAAC;IACd;;IAEA;IACA1B,UAAU,CAACgB,OAAO,CAACW,CAAC,IAAI;MACtBpB,GAAG,CAACqB,SAAS,GAAC,MAAM;MACpBrB,GAAG,CAACM,WAAW,GAAC,MAAM;MACtBN,GAAG,CAACO,SAAS,GAAC,CAAC;MACfP,GAAG,CAACsB,QAAQ,CAACF,CAAC,CAACP,CAAC,GAAChB,KAAK,EAACuB,CAAC,CAACL,CAAC,GAAClB,KAAK,EAACuB,CAAC,CAAClB,KAAK,GAACL,KAAK,EAACuB,CAAC,CAACjB,MAAM,GAACN,KAAK,CAAC;MAC9DG,GAAG,CAACuB,UAAU,CAACH,CAAC,CAACP,CAAC,GAAChB,KAAK,EAACuB,CAAC,CAACL,CAAC,GAAClB,KAAK,EAACuB,CAAC,CAAClB,KAAK,GAACL,KAAK,EAACuB,CAAC,CAACjB,MAAM,GAACN,KAAK,CAAC;IAClE,CAAC,CAAC;;IAEF;IACA,IAAIJ,UAAU,CAACY,MAAM,EAAE;MACrB,IAAImB,GAAG,GAAG,IAAI;MACd/B,UAAU,CAACgB,OAAO,CAACW,CAAC,IAAI;QACtB,MAAMK,IAAI,GAAGxC,IAAI,CAACyC,OAAO,CAAC,CAAC,CACzB,CAACN,CAAC,CAACP,CAAC,EAAEO,CAAC,CAACL,CAAC,CAAC,EACV,CAACK,CAAC,CAACP,CAAC,GAACO,CAAC,CAAClB,KAAK,EAAEkB,CAAC,CAACL,CAAC,CAAC,EAClB,CAACK,CAAC,CAACP,CAAC,GAACO,CAAC,CAAClB,KAAK,EAAEkB,CAAC,CAACL,CAAC,GAACK,CAAC,CAACjB,MAAM,CAAC,EAC3B,CAACiB,CAAC,CAACP,CAAC,EAAEO,CAAC,CAACL,CAAC,GAACK,CAAC,CAACjB,MAAM,CAAC,EACnB,CAACiB,CAAC,CAACP,CAAC,EAAEO,CAAC,CAACL,CAAC,CAAC,CACX,CAAC,CAAC;QACHS,GAAG,GAAGA,GAAG,GAAGvC,IAAI,CAAC0C,KAAK,CAACH,GAAG,EAAEC,IAAI,CAAC,GAAGA,IAAI;MAC1C,CAAC,CAAC;MACF,MAAMG,GAAG,GAAG3C,IAAI,CAAC4C,MAAM,CAACL,GAAG,EAAE9B,MAAM,EAAE;QAAEoC,KAAK,EAAE;MAAS,CAAC,CAAC;MACzD,IAAIF,GAAG,IAAIA,GAAG,CAACG,QAAQ,EAAE;QACvB/B,GAAG,CAACM,WAAW,GAAC,MAAM;QACtBN,GAAG,CAACgC,WAAW,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;QACtBhC,GAAG,CAACO,SAAS,GAAC,CAAC;QACf,MAAM0B,QAAQ,GAAGC,IAAI,IAAI;UACvBlC,GAAG,CAACQ,SAAS,CAAC,CAAC;UACf0B,IAAI,CAACzB,OAAO,CAAC,CAAC,CAAC0B,EAAE,EAACC,EAAE,CAAC,EAACzB,CAAC,KAAI;YACzB,MAAMC,CAAC,GAACuB,EAAE,GAACtC,KAAK;cAAEiB,CAAC,GAACsB,EAAE,GAACvC,KAAK;YAC5Bc,CAAC,KAAG,CAAC,GAACX,GAAG,CAACgB,MAAM,CAACJ,CAAC,EAACE,CAAC,CAAC,GAACd,GAAG,CAACiB,MAAM,CAACL,CAAC,EAACE,CAAC,CAAC;UACvC,CAAC,CAAC;UACFd,GAAG,CAACkB,SAAS,CAAC,CAAC;UAAElB,GAAG,CAACmB,MAAM,CAAC,CAAC;QAC/B,CAAC;QACD,MAAMkB,CAAC,GAAGT,GAAG,CAACG,QAAQ;QACtB,IAAIM,CAAC,CAACC,IAAI,KAAG,SAAS,EAAEL,QAAQ,CAACI,CAAC,CAACE,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,KAC9CF,CAAC,CAACE,WAAW,CAAC9B,OAAO,CAACgB,IAAI,IAAEQ,QAAQ,CAACR,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QACnDzB,GAAG,CAACgC,WAAW,CAAC,EAAE,CAAC;MACrB;IACF;EACF,CAAC,EAAE,CAAC3C,KAAK,EAACC,KAAK,EAACC,aAAa,EAACC,eAAe,EAACC,UAAU,EAACC,MAAM,CAAC,CAAC;EAEjE,oBAAOP,OAAA;IAAQS,GAAG,EAAEA,GAAI;IAAC4C,KAAK,EAAE;MAACC,MAAM,EAAC,gBAAgB;MAACC,SAAS,EAAC;IAAE;EAAE;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAC5E;AAACnD,EAAA,CArEuBP,YAAY;AAAA2D,EAAA,GAAZ3D,YAAY;AAAA,IAAA2D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}